import sys,os,requests
import pandas as pd

sys.path.append(os.getcwd())
sys.path.append(os.path.dirname(os.path.dirname(__file__)))
from example import constent
from example.constent import DEVICE_LIMIT as up
from example.constent import CONV_RATE as c
from example.constent import STORAGE_DEVICE as sd
from nsga2_gp.problem import Problem
from nsga2_gp.evolution import Evolution
from nsga2_gp.individual import Individual
from nsga2_gp.utils import calcu_feature,feature_hour
from example.green_power import solve

def main(load):
    evol = solve(load)

    spd_val,return_val = {},{'plan':evol[0].feature_plan,'result':evol[0].objectives[0]}
    for dvc in constent.FEATURE_RUN_COLUME[4:]:
        spd_val[dvc] = constent.SUMMER_LOAD[0]
    for sp_day in constent.SPECIAL_9DAYS:
        return_val[sp_day] = spd_val

    return return_val

if __name__=='__main__':
    # load = {"workday": [30710.359865684313, 32424.963504136176, 26343.31836691784, 23402.050858972714, 31466.139246456245, 29404.1820705795, 32072.02460211823, 32745.146735856084, 31052.116954890793, 29286.697766835285, 33463.946078774075, 29636.647781847056, 39758.90971421667, 40463.81936424404, 24116.691469570425, 35138.40331794309, 2135.296922648603, 5151.845589285519, 6404.293285631984, 6217.690324626677, 5703.2162531203785, 8958.08853133498, 6629.073407347482, 4996.452096458904],
    #         "weekend": [30710.359865684313, 32424.963504136176, 26343.31836691784, 23402.050858972714, 31466.139246456245, 29404.1820705795, 32072.02460211823, 32745.146735856084, 31052.116954890793, 29286.697766835285, 33463.946078774075, 29636.647781847056, 39758.90971421667, 40463.81936424404, 24116.691469570425, 35138.40331794309, 2135.296922648603, 5151.845589285519, 6404.293285631984, 6217.690324626677, 5703.2162531203785, 8958.08853133498, 6629.073407347482, 4996.452096458904],
    #         "holiday": [30710.359865684313, 32424.963504136176, 26343.31836691784, 23402.050858972714, 31466.139246456245, 29404.1820705795, 32072.02460211823, 32745.146735856084, 31052.116954890793, 29286.697766835285, 33463.946078774075, 29636.647781847056, 39758.90971421667, 40463.81936424404, 24116.691469570425, 35138.40331794309, 2135.296922648603, 5151.845589285519, 6404.293285631984, 6217.690324626677, 5703.2162531203785, 8958.08853133498, 6629.073407347482, 4996.452096458904]}
    
    load = {"workday": [0 for _ in range(24)],
            "weekend": [0 for _ in range(24)],
            "holiday": [0 for _ in range(24)]}
    result = main(load)
    print()

